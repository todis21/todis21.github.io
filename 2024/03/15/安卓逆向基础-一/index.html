<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>安卓逆向基础(一) | Tree's Blog</title><meta name="author" content="Tree"><meta name="copyright" content="Tree"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="安卓逆向基础以下内容全部来自安卓逆向这档事 这里只是记录、学习 环境搭建视频：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1wT411N7sV&#x2F;?spm_id_from&#x3D;333.788&amp;vd_source&#x3D;f207ef8a90cd02e940572d9dc7c00d8b （1）安卓模拟器安装 MUMU或雷电 这里使用的是雷电9 （2）模拟器配置 开启ROOT权限 、开">
<meta property="og:type" content="article">
<meta property="og:title" content="安卓逆向基础(一)">
<meta property="og:url" content="http://example.com/2024/03/15/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80-%E4%B8%80/index.html">
<meta property="og:site_name" content="Tree&#39;s Blog">
<meta property="og:description" content="安卓逆向基础以下内容全部来自安卓逆向这档事 这里只是记录、学习 环境搭建视频：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1wT411N7sV&#x2F;?spm_id_from&#x3D;333.788&amp;vd_source&#x3D;f207ef8a90cd02e940572d9dc7c00d8b （1）安卓模拟器安装 MUMU或雷电 这里使用的是雷电9 （2）模拟器配置 开启ROOT权限 、开">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-7pq62v_2560x1440.png">
<meta property="article:published_time" content="2024-03-15T06:48:23.000Z">
<meta property="article:modified_time" content="2024-04-03T01:18:41.296Z">
<meta property="article:author" content="Tree">
<meta property="article:tag" content="安卓逆向">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-7pq62v_2560x1440.png"><link rel="shortcut icon" href="/img/favicon.jfif"><link rel="canonical" href="http://example.com/2024/03/15/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80-%E4%B8%80/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '安卓逆向基础(一)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-03 09:18:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/bg.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.jfif" onerror="onerror=null;src='/img/404.png'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-7pq62v_2560x1440.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Tree's Blog"><span class="site-name">Tree's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">安卓逆向基础(一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-15T06:48:23.000Z" title="发表于 2024-03-15 14:48:23">2024-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-03T01:18:41.296Z" title="更新于 2024-04-03 09:18:41">2024-04-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="安卓逆向基础(一)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="安卓逆向基础"><a href="#安卓逆向基础" class="headerlink" title="安卓逆向基础"></a>安卓逆向基础</h1><p>以下内容全部来自<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1wT411N7sV/?spm_id_from=333.788&vd_source=f207ef8a90cd02e940572d9dc7c00d8b">安卓逆向这档事</a></p>
<p>这里只是记录、学习</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1wT411N7sV/?spm_id_from=333.788&vd_source=f207ef8a90cd02e940572d9dc7c00d8b">https://www.bilibili.com/video/BV1wT411N7sV/?spm_id_from=333.788&amp;vd_source=f207ef8a90cd02e940572d9dc7c00d8b</a></p>
<p>（1）安卓模拟器安装</p>
<p>MUMU或雷电</p>
<p>这里使用的是雷电9</p>
<p>（2）模拟器配置</p>
<p>开启ROOT权限 、开启磁盘可写</p>
<p>（3）安装面具Magisk和LSPosed</p>
<p>Magisk Delta :<a target="_blank" rel="noopener" href="https://huskydg.github.io/magisk-files/">https://huskydg.github.io/magisk-files/</a></p>
<p>LSPosed: <a target="_blank" rel="noopener" href="https://github.com/LSPosed/LSPosed">https://github.com/LSPosed/LSPosed</a>  （zygisk）</p>
<p>（4）核心破解（软件）</p>
<p>CorePatch： <a target="_blank" rel="noopener" href="https://github.com/LSPosed/CorePatch">https://github.com/LSPosed/CorePatch</a></p>
<p>核心破解是一款基于xposed模块开发的小工具。可以用来去除系统签名校验，直接安装修改过的未签名APK，禁用apk签名验证、覆盖安装不同签名应用的功能。</p>
<p>（5）算法助手</p>
<p>com.junge.algorithmaide:  <a target="_blank" rel="noopener" href="https://github.com/Xposed-Modules-Repo/com.junge.algorithmaide?tab=readme-ov-file">https://github.com/Xposed-Modules-Repo/com.junge.algorithmaide?tab=readme-ov-file</a></p>
<p>（6）XappDebug</p>
<p>XappDebug ：<a target="_blank" rel="noopener" href="https://github.com/Palatis/XAppDebug">https://github.com/Palatis/XAppDebug</a>    </p>
<p>动态调试用</p>
<p>PC软件:</p>
<p>（1）jadx-gui：<a target="_blank" rel="noopener" href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a></p>
<p>这个用来反编译看java代码的，MT上也能看,但是要VIP</p>
<p><strong>注意：</strong></p>
<p>Magisk.apk是可以直接装到模拟器，但启动Magisk后会发现不能使用，这就等于没有安装成功。<br>市面上常见的安卓模拟器，都是那些开发商（比如雷电、夜神、mumu等）定制的，而这些系统是没有开放boot.img和system.img给大家。<br>以前装Magisk是基于修补boot.img再刷入，达到安装Magisk或获取root的效果，而模拟器没有boot.img，怎么刷Magisk呢？<br>所以就有了Magisk的分支——Magisk Terminal Emulator，它是开发者基于Magisk开发的，但不是修补boot.img，而是把Magisk安装到system分区中。<br>Magisk Terminal Emulator它是一个类似命令行窗口（如上图），对小白并不友好，容易操作出错。所以开发者停更了这个版本，又开发了新版的Magisk Delta，它界面跟原版Magisk几乎一摸一样，但实际就是对原版Magisk加了个安装到system分区的方式（也许还有其它变化，）。</p>
<p>（4）MT管理器&#x2F;NP管理器</p>
<p>MT: <a target="_blank" rel="noopener" href="https://mt2.cn/">https://mt2.cn/</a></p>
<p>NP: <a target="_blank" rel="noopener" href="https://github.com/githubXiaowangzi/NP-Manager">https://github.com/githubXiaowangzi/NP-Manager</a></p>
<h2 id="APK文件结构"><a href="#APK文件结构" class="headerlink" title="APK文件结构"></a>APK文件结构</h2><p>apk 全称 Android Package，它相当于一个压缩文件，只要在电脑上将apk后缀改为rar即可解压。</p>
<table>
<thead>
<tr>
<th>文件</th>
<th>注释</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>assets目录</td>
<td>存放APK的静态资源文件，比如视频，音频，图片等</td>
<td></td>
</tr>
<tr>
<td>lib 目录</td>
<td>armeabi-v7a基本通用所有android设备，arm64-v8a只适用于64位的android设备，x86常见用于android模拟器，其目录下的.so文件是c或c++编译的动态链接库文件</td>
<td></td>
</tr>
<tr>
<td>META-INF目录</td>
<td>保存应用的签名信息，签名信息可以验证APK文件的完整性，相当于APK的身份证(验证文件是否又被修改)</td>
<td></td>
</tr>
<tr>
<td>res目录</td>
<td>res目录存放资源文件，包括图片，字符串等等，APK的脸蛋由他的layout文件设计</td>
<td></td>
</tr>
<tr>
<td>AndroidMainfest.xml文件</td>
<td>APK的应用清单信息，它描述了应用的名字，版本，权限，引用的库文件等等信息</td>
<td></td>
</tr>
<tr>
<td>classes.dex文件</td>
<td>classes.dex是java源码编译后生成的java字节码文件，APK运行的主要逻辑</td>
<td></td>
</tr>
<tr>
<td>resources.arsc文件</td>
<td>resources.arsc是编译后的二进制资源文件，它是一个映射表，映射着资源和id，通过R文件中的id就可以找到对应的资源</td>
<td></td>
</tr>
</tbody></table>
<p><strong>汉化</strong>：使用专门的工具对外文版的软件资源进行读取、翻译、修改、回写等一系列处理，使软件的菜单、对话框、提示等用户界面显示为中文，而程序的内核和功能保持不变，这个过程即为软件汉化</p>
<p>基本上字符串都是在arsc里，建议一键汉化，然后再润色。 少量没汉化到的字符串需要定位去逐个汉化。</p>
<hr>
<p><code>AndroidManifest.xml</code>文件是整个应用程序的信息描述文件，定义了应用程序中包含的Activity,Service,Content provider和BroadcastReceiver组件信息。每个应用程序在根目录下必须包含一个AndroidManifest.xml文件，且文件名不能修改。它描述了package中暴露的组件，他们各自的实现类，各种能被处理的数据和启动位置。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>定义</th>
</tr>
</thead>
<tbody><tr>
<td>versionCode</td>
<td>版本号，主要用来更新，例如:12</td>
</tr>
<tr>
<td>versionName</td>
<td>版本名，给用户看的，例如:1.2</td>
</tr>
<tr>
<td>package</td>
<td>包名，例如：com.zj.52pj.demo</td>
</tr>
<tr>
<td>uses-permission android:name&#x3D;””</td>
<td>应用权限，例如：android.permission.INTERNET 代表网络权限</td>
</tr>
<tr>
<td>android:label&#x3D;”@string&#x2F;app_name”</td>
<td>应用名称</td>
</tr>
<tr>
<td>android:icon&#x3D;”@mipmap&#x2F;ic_launcher”</td>
<td>应用图标路径</td>
</tr>
<tr>
<td>android:debuggable&#x3D;”true”</td>
<td>应用是否开启debug权限</td>
</tr>
</tbody></table>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/cb35179c3ff8786b19fc1d2d2ecae12e.webp" alt="cb35179c3ff8786b19fc1d2d2ecae12e"></p>
<h2 id="双开及原理"><a href="#双开及原理" class="headerlink" title="双开及原理"></a>双开及原理</h2><p>双开：简单来说，就是手机同时运行两个或多个相同的应用，例如同时运行两个微信</p>
<table>
<thead>
<tr>
<th>原理</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td>修改包名</td>
<td>让手机系统认为这是2个APP，这样的话就能生成2个数据存储路径，此时的多开就等于你打开了两个互不干扰的APP</td>
</tr>
<tr>
<td>修改Framework</td>
<td>对于有系统修改权限的厂商，可以修改Framework来实现双开的目的，例如：小米自带多开</td>
</tr>
<tr>
<td>通过虚拟化技术实现</td>
<td>虚拟Framework层、虚拟文件系统、模拟Android对组件的管理、虚拟应用进程管理 等一整套虚拟技术，将APK复制一份到虚拟空间中运行，例如：平行空间</td>
</tr>
<tr>
<td>以插件机制运行</td>
<td>利用反射替换，动态代理，hook了系统的大部分与system—server进程通讯的函数，以此作为“欺上瞒下”的目的，欺骗系统“以为”只有一个apk在运行，瞒过插件让其“认为”自己已经安装。例如：VirtualApp</td>
</tr>
</tbody></table>
<h2 id="安卓四大组件"><a href="#安卓四大组件" class="headerlink" title="安卓四大组件"></a>安卓四大组件</h2><table>
<thead>
<tr>
<th>组件</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Activity(活动)</td>
<td>在应用中的一个Activity可以用来表示一个界面，意思可以理解为“活动”，即一个活动开始，代表 Activity组件启动，活动结束，代表一个Activity的生命周期结束。一个Android应用必须通过Activity来运行和启动，Activity的生命周期交给系统统一管理。</td>
</tr>
<tr>
<td>Service(服务)</td>
<td>Service它可以在后台执行长时间运行操作而没有用户界面的应用组件，不依赖任何用户界面，例如后台播放音乐，后台下载文件等。</td>
</tr>
<tr>
<td>Broadcast Receiver(广播接收器)</td>
<td>一个用于接收广播信息，并做出对应处理的组件。比如我们常见的系统广播：通知时区改变、电量低、用户改变了语言选项等。</td>
</tr>
<tr>
<td>Content Provider(内容提供者)</td>
<td>作为应用程序之间唯一的共享数据的途径，Content Provider主要的功能就是存储并检索数据以及向其他应用程序提供访问数据的接口。Android内置的许多数据都是使用Content Provider形式，供开发者调用的（如视频，音频，图片，通讯录等）</td>
</tr>
</tbody></table>
<h2 id="Activity生命周期"><a href="#Activity生命周期" class="headerlink" title="Activity生命周期"></a>Activity生命周期</h2><table>
<thead>
<tr>
<th>函数名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>onCreate()</td>
<td>一个Activity启动后第一个被调用的函数，常用来在此方法中进行Activity的一些初始化操作。例如创建View，绑定数据，注册监听，加载参数等。</td>
</tr>
<tr>
<td>onStart()</td>
<td>当Activity显示在屏幕上时，此方法被调用但此时还无法进行与用户的交互操作。</td>
</tr>
<tr>
<td>onResume()</td>
<td>这个方法在onStart()之后调用，也就是在Activity准备好与用户进行交互的时候调用，此时的Activity一定位于Activity栈顶，处于运行状态。</td>
</tr>
<tr>
<td>onPause()</td>
<td>这个方法是在系统准备去启动或者恢复另外一个Activity的时候调用，通常在这个方法中执行一些释放资源的方法，以及保存一些关键数据。</td>
</tr>
<tr>
<td>onStop()</td>
<td>这个方法是在Activity完全不可见的时候调用的。</td>
</tr>
<tr>
<td>onDestroy()</td>
<td>这个方法在Activity销毁之前调用，之后Activity的状态为销毁状态。</td>
</tr>
<tr>
<td>onRestart()</td>
<td>当Activity从停止stop状态恢进入start状态时调用状态。</td>
</tr>
</tbody></table>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/d810cf812e87dd8cbbb663cf9b1247a4.webp" alt="d810cf812e87dd8cbbb663cf9b1247a4"></p>
<p><strong>activity的切换</strong></p>
<pre><code class="xml">        &lt;!---声明实现应用部分可视化界面的 Activity，必须使用 AndroidManifest 中的 &lt;activity&gt; 元素表示所有 Activity。系统不会识别和运行任何未进行声明的Activity。-----&gt;
        &lt;activity  
            android:label=&quot;@string/app_name&quot;  
            android:name=&quot;com.zj.wuaipojie.ui.MainActivity&quot;  
            android:exported=&quot;true&quot;&gt;  &lt;!--当前Activity是否可以被另一个Application的组件启动：true允许被启动；false不允许被启动--&gt;
            &lt;!---指明这个activity可以以什么样的意图(intent)启动---&gt;
            &lt;intent-filter&gt;  
                &lt;!--表示activity作为一个什么动作启动，android.intent.action.MAIN表示作为主activity启动---&gt;
                &lt;action  
                    android:name=&quot;android.intent.action.MAIN&quot; /&gt;  
                &lt;!--这是action元素的额外类别信息，android.intent.category.LAUNCHER表示这个activity为当前应用程序优先级最高的Activity--&gt;
                &lt;category  
                    android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;  
            &lt;/intent-filter&gt;  
        &lt;/activity&gt;  
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.ChallengeFirst&quot; /&gt;
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.ChallengeFifth&quot;  
            android:exported=&quot;true&quot; /&gt;  
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.ChallengeFourth&quot;  
            android:exported=&quot;true&quot; /&gt;  
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.ChallengeThird&quot;  
            android:exported=&quot;false&quot; /&gt;  
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.ChallengeSecond&quot;  
            android:exported=&quot;false&quot; /&gt;  
        &lt;activity  
            android:name=&quot;com.zj.wuaipojie.ui.AdActivity&quot; /&gt;  
</code></pre>
<h2 id="smali语法"><a href="#smali语法" class="headerlink" title="smali语法"></a>smali语法</h2><p><strong>注释符</strong> ：#</p>
<p><strong>关键字</strong></p>
<table>
<thead>
<tr>
<th>名称</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>.class</td>
<td>类名</td>
</tr>
<tr>
<td>.super</td>
<td>父类名，继承的上级类名名称</td>
</tr>
<tr>
<td>.source</td>
<td>源名</td>
</tr>
<tr>
<td>.field</td>
<td>变量</td>
</tr>
<tr>
<td>.method</td>
<td>方法名</td>
</tr>
<tr>
<td>.register</td>
<td>寄存器</td>
</tr>
<tr>
<td>.end method</td>
<td>方法名的结束</td>
</tr>
<tr>
<td>public</td>
<td>公有</td>
</tr>
<tr>
<td>protected</td>
<td>半公开，只有同一家人才能用</td>
</tr>
<tr>
<td>private</td>
<td>私有，只能自己使用</td>
</tr>
<tr>
<td>.parameter</td>
<td>方法参数</td>
</tr>
<tr>
<td>.prologue</td>
<td>方法开始</td>
</tr>
<tr>
<td>.line xxx</td>
<td>位于第xxx行</td>
</tr>
</tbody></table>
<p><strong>数据类型对应</strong></p>
<table>
<thead>
<tr>
<th>smali类型</th>
<th>java类型</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>V</td>
<td>void</td>
<td>无返回值</td>
</tr>
<tr>
<td>Z</td>
<td>boolean</td>
<td>布尔值类型，返回0或1</td>
</tr>
<tr>
<td>B</td>
<td>byte</td>
<td>字节类型，返回字节</td>
</tr>
<tr>
<td>S</td>
<td>short</td>
<td>短整数类型，返回数字</td>
</tr>
<tr>
<td>C</td>
<td>char</td>
<td>字符类型，返回字符</td>
</tr>
<tr>
<td>I</td>
<td>int</td>
<td>整数类型，返回数字</td>
</tr>
<tr>
<td>J</td>
<td>long （64位 需要2个寄存器存储）</td>
<td>长整数类型，返回数字</td>
</tr>
<tr>
<td>F</td>
<td>float</td>
<td>单浮点类型，返回数字</td>
</tr>
<tr>
<td>D</td>
<td>double （64位 需要2个寄存器存储）</td>
<td>双浮点类型，返回数字</td>
</tr>
<tr>
<td>string</td>
<td>String</td>
<td>文本类型，返回字符串</td>
</tr>
<tr>
<td>Lxxx&#x2F;xxx&#x2F;xxx</td>
<td>object</td>
<td>对象类型，返回对象</td>
</tr>
</tbody></table>
<p><strong>常用指令</strong></p>
<table>
<thead>
<tr>
<th>关键字</th>
<th>注释</th>
</tr>
</thead>
<tbody><tr>
<td>const</td>
<td>重写整数属性，真假属性内容，只能是数字类型</td>
</tr>
<tr>
<td>const-string</td>
<td>重写字符串内容</td>
</tr>
<tr>
<td>const-wide</td>
<td>重写长整数类型，多用于修改到期时间。</td>
</tr>
<tr>
<td>return</td>
<td>返回指令</td>
</tr>
<tr>
<td>if-eq</td>
<td>全称equal(a&#x3D;b)，比较寄存器ab内容，相同则跳</td>
</tr>
<tr>
<td>if-ne</td>
<td>全称not equal(a!&#x3D;b)，ab内容不相同则跳</td>
</tr>
<tr>
<td>if-eqz</td>
<td>全称equal zero(a&#x3D;0)，z即是0的标记，a等于0则跳</td>
</tr>
<tr>
<td>if-nez</td>
<td>全称not equal zero(a!&#x3D;0)，a不等于0则跳</td>
</tr>
<tr>
<td>if-ge</td>
<td>全称garden equal(a&gt;&#x3D;b)，a大于或等于则跳</td>
</tr>
<tr>
<td>if-le</td>
<td>全称little equal(a&lt;&#x3D;b)，a小于或等于则跳</td>
</tr>
<tr>
<td>goto</td>
<td>强制跳到指定位置</td>
</tr>
<tr>
<td>switch</td>
<td>分支跳转，一般会有多个分支线，并根据指令跳转到适当位置</td>
</tr>
<tr>
<td>iget</td>
<td>获取寄存器数据，表示获取一个int类型的字段</td>
</tr>
<tr>
<td>check-cast</td>
<td>表示进行类型转换检查</td>
</tr>
<tr>
<td>invoke-static</td>
<td>调用静态方法</td>
</tr>
<tr>
<td>move-result-object</td>
<td>表示将前一个方法调用的返回值存储到指定寄存器中</td>
</tr>
<tr>
<td>invoke-virtual</td>
<td>表示调用虚拟方法</td>
</tr>
<tr>
<td>sget-object</td>
<td>表示获取一个静态对象</td>
</tr>
<tr>
<td>if-lt</td>
<td>全称little equal(a&lt;b)，a小于则跳</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>其余指令可用语法工具查询</p>
<p>例如：</p>
<pre><code>//一个私有、静态、不可变的方法   方法名
.method private static final onCreate$lambda-2(Lkotlin/jvm/internal/Ref$IntRef;Lcom/zj/wuaipojie/ui/ChallengeSecond;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/widget/ImageView;Landroid/view/View;)Z //(这里面是方法的参数)这里是方法返回值类型，表示布尔值类型，返回假或真
    .registers 7  //寄存器数量

    .line 33  //代码所在的行数
    iget p0, p0, Lkotlin/jvm/internal/Ref$IntRef;-&gt;element:I  //读取p0(第一个参数，参考寄存器知识)中element的值赋值给p0

    const/4 p5, 0x1  //p5赋值1

    const/16 v0, 0xa //v0赋值10，在16进制里a表示10 ,16指位数

    if-ge p0, v0, :cond_15  //判断p0的值是否大于或等于v0的值(即p0的值是否大于或等于10)，如果大于或等于则跳转到:cond_15

    .line 34  //以下是常见的Toast弹窗代码
    check-cast p1, Landroid/content/Context; //检查Context对象引用

    const-string p0, &quot;请先获取10个硬币哦&quot; //弹窗文本信息，把&quot;&quot;里的字符串数据赋值给p0

    check-cast p0, Ljava/lang/CharSequence; //检查CharSequence对象引用

    invoke-static &#123;p1, p0, p5&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast; 
    //将弹窗文本、显示时间等信息传给p1

    move-result-object p0  //结果传递给p0

    invoke-virtual &#123;p0&#125;, Landroid/widget/Toast;-&gt;show()V  //当看到这个Toast;-&gt;show你就应该反应过来这里是弹窗代码

    goto :goto_31  //跳转到:goto_31

    :cond_15 //跳转的一个地址
    
    invoke-virtual &#123;p1&#125;, Lcom/zj/wuaipojie/ui/ChallengeSecond;-&gt;isvip()Z  //判断isvip方法的返回值是否为真(即结果是否为1)
  
    move-result p0  //结果赋值给p0
  
    if-eqz p0, :cond_43 //如果结果为0则跳转cond_43地址
    
    const p0, 0x7f0d0018  //在arsc中的id索引，这个值可以进行查询

    .line 37
    invoke-virtual &#123;p2, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V //设置图片资源

    const p0, 0x7f0d0008

    .line 38
    invoke-virtual &#123;p3, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V

    const p0, 0x7f0d000a

    .line 39
    invoke-virtual &#123;p4, p0&#125;, Landroid/widget/ImageView;-&gt;setImageResource(I)V

    .line 40
    sget-object p0, Lcom/zj/wuaipojie/util/SPUtils;-&gt;INSTANCE:Lcom/zj/wuaipojie/util/SPUtils; 

    check-cast p1, Landroid/content/Context;

    const/4 p2, 0x2 //p2赋值2

    const-string p3, &quot;level&quot; //sp的索引

    invoke-virtual &#123;p0, p1, p3, p2&#125;, Lcom/zj/wuaipojie/util/SPUtils;-&gt;saveInt(Landroid/content/Context;Ljava/lang/String;I)V //写入数据

    goto :goto_50 //跳转地址
    
    :cond_43
  
    check-cast p1, Landroid/content/Context;
  
  
    const-string p0, &quot;\u8bf7\u5148\u5145\u503c\u5927\u4f1a\u5458\u54e6\uff01&quot; //请先充值大会员哦！
  
  
    check-cast p0, Ljava/lang/CharSequence;
  
  
    invoke-static &#123;p1, p0, p5&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
  
  
    move-result-object p0
  
    invoke-virtual &#123;p0&#125;, Landroid/widget/Toast;-&gt;show()V
  
  
    :goto_50
    return p5  //返回p5的值
.end method //方法结束


//判断是否是大会员的方法
.method public final isvip()Z
    .registers 2
    
    const/4 v0, 0x0 //v0赋值0
    
    return v0 //返回v0的值
    
.end method
</code></pre>
<p><strong>静态修改</strong></p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/fe7852e13a354ab54af29ff3a3361b3f.webp" alt="fe7852e13a354ab54af29ff3a3361b3f"></p>
<p>修改判断：例如大于改成小于等于</p>
<p>强制跳转： goto</p>
<h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><p>在smali里的所有操作都必须经过寄存器来进行:本地寄存器用v开头数字结尾的符号来表示，如v0、 v1、v2。 参数寄存器则使用p开头数字结尾的符号来表示，如p0、p1、p2。特别注意的是，p0不一定是函数中的第一个参数，在非static函数中，p0代指“this”，p1表示函数的第一个 参数，p2代表函数中的第二个参数。而在static函数中p0才对应第一个参数(因为Java的static方法中没有this方法）</p>
<h2 id="去广告-x2F-弹窗"><a href="#去广告-x2F-弹窗" class="headerlink" title="去广告&#x2F;弹窗"></a>去广告&#x2F;弹窗</h2><p><strong>广告</strong></p>
<p>启动广告流程： 启动Activity-&gt;广告Activity-&gt;主页Activity</p>
<p>修改方法： 1.修改加载时间 2.Acitivity切换定位，修改Intent的Activity类名</p>
<p><strong>弹窗</strong></p>
<p>修改方法： </p>
<p>1.修改xml中的versiocode(对于升级弹窗) </p>
<p>2.Hook弹窗(推荐算法助手开启弹窗定位) </p>
<p>3.修改dex弹窗代码(定位弹窗代码，在dex把show方法注释掉) </p>
<p>4.抓包修改响应体(也可以路由器拦截)</p>
<p>&#x2F;&#x2F;1.开发者助手抓布局 2.MT管理器xml搜索定位 3.修改xml代码</p>
<p>5.修改弹窗的大小，将长宽修改为0</p>
<p>6.关闭窗口</p>
<pre><code>android:visibility=&quot;gone&quot;  //视图不可见
</code></pre>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>广告关键词</td>
<td>厂商</td>
<td>文档</td>
</tr>
<tr>
<td>com.qq.e.ads</td>
<td>腾讯优量汇广告</td>
<td><a target="_blank" rel="noopener" href="https://developers.adnet.qq.com/doc/android/union/union_splash">https://developers.adnet.qq.com/doc/android/union/union_splash</a></td>
</tr>
<tr>
<td>CSJAD、TTAdSdk、bytedance、pangolin</td>
<td>穿山甲广告</td>
<td><a target="_blank" rel="noopener" href="https://www.csjplatform.com/supportcenter/5395">https://www.csjplatform.com/supportcenter/5395</a></td>
</tr>
<tr>
<td>ADMob、google.ads</td>
<td>谷歌广告</td>
<td><a target="_blank" rel="noopener" href="https://developers.google.com/admob/android/app-open?hl=zh-cn#extend">https://developers.google.com/admob/android/app-open?hl=zh-cn#extend</a></td>
</tr>
<tr>
<td>TorchAd</td>
<td>360广告</td>
<td><a target="_blank" rel="noopener" href="https://easydoc.soft.360.cn/doc?project=186589faed863b0a24f15f9bcbafd5c7&doc=2cbbbe19c5cb90f5e7a41c7037b0029a&config=title_menu_toc">https://easydoc.soft.360.cn/doc?project=186589faed863b0a24f15f9bcbafd5c7&amp;doc=2cbbbe19c5cb90f5e7a41c7037b0029a&amp;config=title_menu_toc</a></td>
</tr>
<tr>
<td>kwad</td>
<td>快手广告</td>
<td><a target="_blank" rel="noopener" href="https://u.kuaishou.com/home/help/detail/1334/1370/1310">https://u.kuaishou.com/home/help/detail/1334/1370/1310</a></td>
</tr>
<tr>
<td>baidu.mobads</td>
<td>百度广告</td>
<td><a target="_blank" rel="noopener" href="http://bce.ssp.baidu.com/mssp/sdk/BaiduMobAds_MSSP_bd_SDK_android_v5.1.pdf">http://bce.ssp.baidu.com/mssp/sdk/BaiduMobAds_MSSP_bd_SDK_android_v5.1.pdf</a></td>
</tr>
<tr>
<td>MimoSdk</td>
<td>米盟广告</td>
<td><a target="_blank" rel="noopener" href="https://t5.a.market.xiaomi.com/download/AdCenter/0d3a369516ee146e8a9d5c290985939da4624fe0a/AdCenter0d3a369516ee146e8a9d5c290985939da4624fe0a.html">https://t5.a.market.xiaomi.com/download/AdCenter/0d3a369516ee146e8a9d5c290985939da4624fe0a/AdCenter0d3a369516ee146e8a9d5c290985939da4624fe0a.html</a></td>
</tr>
<tr>
<td>sigmob.sdk</td>
<td>sigmob广告</td>
<td><a target="_blank" rel="noopener" href="https://doc.sigmob.com/#/Sigmob%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/SDK%E9%9B%86%E6%88%90%E8%AF%B4%E6%98%8E/Android/SDK%E6%8E%A5%E5%85%A5%E9%85%8D%E7%BD%AE/">https://doc.sigmob.com/#/Sigmob%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/SDK%E9%9B%86%E6%88%90%E8%AF%B4%E6%98%8E/Android/SDK%E6%8E%A5%E5%85%A5%E9%85%8D%E7%BD%AE/</a></td>
</tr>
<tr>
<td>TradPlus</td>
<td>TradPlus聚合广告</td>
<td><a target="_blank" rel="noopener" href="https://service.cocos.com/document/zh/tradplusad.html">https://service.cocos.com/document/zh/tradplusad.html</a></td>
</tr>
<tr>
<td>通过免广告关键字来实现部分广告的去除</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>第三方广告sdk汇总：<a target="_blank" rel="noopener" href="https://static.52mvp.com/policy_other_sdk.html">https://static.52mvp.com/policy_other_sdk.html</a></p>
<p>查看厂商的官方文档找到关闭广告的方法</p>
<p>从广告SDK初始化的地方下手</p>
<h2 id="App动态调试"><a href="#App动态调试" class="headerlink" title="App动态调试"></a>App动态调试</h2><p>动态调试是指自带的调试器跟踪自己软件的运行，可以在调试的过程中知道参数或者局部变量的值以及履清代码运行的先后顺序。多用于爆破注册码(CTF必备技能)</p>
<p><strong>动态调试步骤</strong>:</p>
<p><strong>（一）修改debug权限：</strong></p>
<p>总的来说就是修改ro.debuggable的值为1</p>
<ul>
<li>方法一:在AndroidManifest.xml里添加可调试权限   遇到签名校验时不可用</li>
</ul>
<pre><code>android:debuggable=&quot;true&quot;
</code></pre>
<ul>
<li>方法二：XappDebug模块hook对应的app (建议使用这个)</li>
<li>方法三：Magisk命令(重启会失效)</li>
</ul>
<pre><code> adb shell #adb进入命令行模式
    
 su #切换至超级用户
    
 magisk resetprop ro.debuggable 1
    
 stop;start; #一定要通过该方式重启
</code></pre>
<ul>
<li>方法四: 刷入MagiskHide Props Config模块(永久有效)</li>
</ul>
<p>一般来说，在4选项中如果有ro.debuggable那就直接修改 没有的话就选5</p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/image-20240316222356144.png" alt="image-20240316222356144"></p>
<p><strong>（二） 端口转发以及开启adb权限</strong></p>
<p>版本号点击七次开启开发者模式并开启adb调试权限（usb调试）</p>
<p>adb connect xxxx:xxx</p>
<p><strong>（三）下段点</strong></p>
<p>ctrl+b下断点</p>
<p><strong>（四）debug模式启动</strong></p>
<pre><code>adb shell am start -D -n com.zj.wuaipojie/.ui.MainActivity
//adb shell am start -D -n 包名/类名
</code></pre>
<p>am start -n 表示启动一个activity</p>
<p>am start -D 表示将应用设置为可调试模式</p>
<p><strong>（五）Jeb附加调试进程</strong></p>
<p><strong>（六）Log插桩</strong></p>
<p>有签名校验时不可用</p>
<p>Log插桩指的是反编译APK文件时，在对应的smali文件里，添加相应的smali代码，将程序中的关键信息，以log日志的形式进行输出。</p>
<p>首先将<code>日志插壮.dex</code>改名为为classes2.dex并丢进apk里面然后安装运行</p>
<p>然后再需要获取值的地方插入调用命令：</p>
<pre><code>invoke-static &#123;对应寄存器&#125;, Lcom/mtools/LogUtils;-&gt;v(Ljava/lang/Object;)V
</code></pre>
<p>使用<code>算法助手</code>监听日志输出(选择对应app，打开应用总开关，打开Log捕获)</p>
<h2 id="校验"><a href="#校验" class="headerlink" title="校验"></a>校验</h2><p>校验是开发者在数据传送时采用的一种校正数据的一种方式 常见的校验有:签名校验(最常见)、dexcrc校验、apk完整性校验、路径文件校验等</p>
<h2 id="APK签名"><a href="#APK签名" class="headerlink" title="APK签名"></a>APK签名</h2><p>通过对 Apk 进行签名，开发者可以证明对 Apk 的所有权和控制权，可用于安装和更新其应用。而在 Android 设备上的安装 Apk ，如果是一个没有被签名的 Apk，则会被拒绝安装。在安装 Apk 的时候，软件包管理器也会验证 Apk 是否已经被正确签名，并且通过签名证书和数据摘要验证是否合法没有被篡改。只有确认安全无篡改的情况下，才允许安装在设备上。</p>
<p>简单来说，APK 的签名主要作用有两个：</p>
<ol>
<li>证明 APK 的所有者。</li>
<li>允许 Android 市场和设备校验 APK 的正确性。</li>
</ol>
<p>Android 目前支持以下四种应用签名方案：</p>
<pre><code>v1 方案：基于 JAR 签名。

v2 方案：APK 签名方案 v2（在 Android 7.0 中引入）

v3 方案：APK 签名方案 v3（在 Android 9 中引入）

v4 方案：APK 签名方案 v4（在 Android 11 中引入）
</code></pre>
<p>V1 签名的机制主要就在 META-INF 目录下的三个文件，MANIFEST.MF，ANDROID.SF，ANDROID.RSA，他们都是 V1 签名的产物。 （1）MANIFEST.MF：这是摘要文件。程序遍历Apk包中的所有文件(entry)，对非文件夹非签名文件的文件，逐个用SHA1(安全哈希算法)生成摘要信息，再用Base64进行编码。如果你改变了apk包中的文件，那么在apk安装校验时，改变后的文件摘要信息与MANIFEST.MF的检验信息不同，于是程序就不能成功安装。</p>
<p> <img src="https://raw.githubusercontent.com/todis21/image/main/2024/1d7ab639d33cce3e5d833dd68ce90f56.webp" alt="img"></p>
<p>（2）c.SF：这是对摘要的签名文件。对前一步生成的MANIFEST.MF，使用SHA1-RSA算法，用开发者的私钥进行签名。在安装时只能使用公钥才能解密它。解密之后，将它与未加密的摘要信息（即，MANIFEST.MF文件）进行对比，如果相符，则表明内容没有被异常修改。 </p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/e9ec81f588d2f36b4864db4eb7527eb4.webp" alt="img"></p>
<p>（3）ANDROID.RSA文件中保存了公钥、所采用的加密算法等信息。 </p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/4f081fbd5d9cc7007c8e69a30a54066d.webp" alt="img"></p>
<p>在某些情况下，直接对apk进行v1签名可以绕过apk的签名校验</p>
<p>v2方案会将 APK 文件视为 blob，并对整个文件进行签名检查。对 APK 进行的任何修改（包括对 ZIP 元数据进行的修改）都会使 APK 签名作废。这种形式的 APK 验证不仅速度要快得多，而且能够发现更多种未经授权的修改。</p>
<h2 id="签名校验"><a href="#签名校验" class="headerlink" title="签名校验"></a>签名校验</h2><p>如何判断是否有签名校验？ </p>
<p>不做任何修改，直接签名安装，应用闪退则说明大概率有签名校验</p>
<p>一般来说，普通的签名校验会导致软件的闪退，黑屏，卡启动页等 当然，以上都算是比较好的，有一些比较狠的作者，则会直接rm -rf &#x2F;，把基带都格掉的一键变砖。</p>
<pre><code>kill/killProcess-----kill/KillProcess()可以杀死当前应用活动的进程，这一操作将会把所有该进程内的资源（包括线程全部清理掉）.当然，由于ActivityManager时刻监听着进程，一旦发现进程被非正常Kill，它将会试图去重启这个进程。这就是为什么，有时候当我们试图这样去结束掉应用时，发现它又自动重新启动的原因.

system.exit-----杀死了整个进程，这时候活动所占的资源也会被释放。

finish----------仅仅针对Activity，当调用finish()时，只是将活动推向后台，并没有立即释放内存，活动的资源并没有被清理
</code></pre>
<p>三角校验： 所谓三角校验，就是so检测dex，动态加载的dex(在软件运行时会解压释放一段dex文件，检测完后就删除)检测so，dex检测动态加载的dex</p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/2501f84f8f0b1e23adf198e9597429c6.webp" alt="|300"></p>
<p>普通获取签名校验代码：</p>
<pre><code>private boolean SignCheck() &#123;
    String trueSignMD5 = &quot;d0add9987c7c84aeb7198c3ff26ca152&quot;;
    String nowSignMD5 = &quot;&quot;;
    try &#123;
        // 得到签名的MD5
        PackageInfo packageInfo = getPackageManager().getPackageInfo(getPackageName(),PackageManager.GET_SIGNATURES);
        Signature[] signs = packageInfo.signatures;
        String signBase64 = Base64Util.encodeToString(signs[0].toByteArray());
        nowSignMD5 = MD5Utils.MD5(signBase64);
    &#125; catch (PackageManager.NameNotFoundException e) &#123;
        e.printStackTrace();
    &#125;
    return trueSignMD5.equals(nowSignMD5);
&#125;
</code></pre>
<p>系统将应用的签名信息封装在 PackageInfo 中，调用 PackageManager 的 getPackageInfo(String packageName, int flags) 即可获取指定包名的签名信息</p>
<h2 id="签名校验对抗"><a href="#签名校验对抗" class="headerlink" title="签名校验对抗"></a>签名校验对抗</h2><p>方法一:核心破解插件，不签名安装应用</p>
<p>方法二:一键过签名工具，例如MT、NP、ARMPro、CNFIX、Modex的去除签名校验功能</p>
<p>方法三:具体分析签名校验逻辑(手撕签名校验)</p>
<p>方法四:io重定向–VA&amp;SVC：ptrace+seccomp <a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-273160.htm">SVC的TraceHook沙箱的实现&amp;无痕Hook实现思路</a></p>
<p>方法五:去作者家严刑拷打拿到.jks文件(签名密钥文件)和密码</p>
<h2 id="PM代理"><a href="#PM代理" class="headerlink" title="PM代理"></a>PM代理</h2><p>（已过时）</p>
<p>思路源自：<a target="_blank" rel="noopener" href="https://github.com/fourbrother/HookPmsSignature">Android中Hook 应用签名方法</a></p>
<p>PackageManagerService（简称PMS），是Android系统核心服务之一，处理包管理相关的工作，常见的比如安装、卸载应用等。</p>
<h2 id="IO重定向-✔"><a href="#IO重定向-✔" class="headerlink" title="IO重定向(✔)"></a>IO重定向(✔)</h2><p>什么是IO重定向？</p>
<p>例：在读A文件的时候指向B文件</p>
<p><a target="_blank" rel="noopener" href="https://github.com/virjarRatel/ratel-core">平头哥的核心代码</a> <a target="_blank" rel="noopener" href="https://github.com/asLody/VirtualApp">Virtual Engine for Android(Support 12.0 in business version)</a></p>
<p>IO重定向可以干嘛？</p>
<p>1，可以让文件只读，不可写</p>
<p>2，禁止访问文件</p>
<p>3，路径替换</p>
<p>具体实现： 过签名检测(读取原包) 风控对抗(例:一个文件记录App启动的次数) 过Root检测，Xposed检测(文件不可取)</p>
<h2 id="各种检测"><a href="#各种检测" class="headerlink" title="各种检测"></a>各种检测</h2><h3 id="root检测："><a href="#root检测：" class="headerlink" title="root检测："></a>root检测：</h3><p>反制手段 1.算法助手、对话框取消等插件一键hook</p>
<p>2.分析具体的检测代码</p>
<p>3.利用IO重定向使文件不可读</p>
<p>4.修改Andoird源码，去除常见指纹</p>
<pre><code>fun isDeviceRooted(): Boolean &#123;
    return checkRootMethod1() || checkRootMethod2() || checkRootMethod3()
&#125;

fun checkRootMethod1(): Boolean &#123;
    val buildTags = android.os.Build.TAGS
    return buildTags != null &amp;&amp; buildTags.contains(&quot;test-keys&quot;)
&#125;

fun checkRootMethod2(): Boolean &#123;
    val paths = arrayOf(&quot;/system/app/Superuser.apk&quot;, &quot;/sbin/su&quot;, &quot;/system/bin/su&quot;, &quot;/system/xbin/su&quot;, &quot;/data/local/xbin/su&quot;, &quot;/data/local/bin/su&quot;, &quot;/system/sd/xbin/su&quot;,
            &quot;/system/bin/failsafe/su&quot;, &quot;/data/local/su&quot;, &quot;/su/bin/su&quot;)
    for (path in paths) &#123;
        if (File(path).exists()) return true
    &#125;
    return false
&#125;

fun checkRootMethod3(): Boolean &#123;
    var process: Process? = null
    return try &#123;
        process = Runtime.getRuntime().exec(arrayOf(&quot;/system/xbin/which&quot;, &quot;su&quot;))
        val bufferedReader = BufferedReader(InputStreamReader(process.inputStream))
        bufferedReader.readLine() != null
    &#125; catch (t: Throwable) &#123;
        false
    &#125; finally &#123;
        process?.destroy()
    &#125;
&#125;
</code></pre>
<p>定义了一个 <code>isDeviceRooted()</code> 函数，该函数调用了三个检测 root 的方法：<code>checkRootMethod1()</code>、<code>checkRootMethod2()</code> 和 <code>checkRootMethod3()</code>。</p>
<p><code>checkRootMethod1()</code> 方法检查设备的 <code>build tags</code> 是否包含 <code>test-keys</code>。这通常是用于测试的设备，因此如果检测到这个标记，则可以认为设备已被 root。</p>
<p><code>checkRootMethod2()</code> 方法检查设备是否存在一些特定的文件，这些文件通常被用于执行 root 操作。如果检测到这些文件，则可以认为设备已被 root。</p>
<p><code>checkRootMethod3()</code> 方法使用 <code>Runtime.exec()</code> 方法来执行 <code>which su</code> 命令，然后检查命令的输出是否不为空。如果输出不为空，则可以认为设备已被 root。</p>
<h3 id="模拟器检测"><a href="#模拟器检测" class="headerlink" title="模拟器检测"></a>模拟器检测</h3><pre><code>fun isEmulator(): Boolean &#123; 
    return Build.FINGERPRINT.startsWith(&quot;generic&quot;) || Build.FINGERPRINT.startsWith(&quot;unknown&quot;) || Build.MODEL.contains(&quot;google_sdk&quot;) Build.MODEL.contains(&quot;Emulator&quot;) || Build.MODEL.contains(&quot;Android SDK built for x86&quot;) || Build.MANUFACTURER.contains(&quot;Genymotion&quot;) || Build.HOST.startsWith(&quot;Build&quot;) || Build.PRODUCT == &quot;google_sdk&quot; 
    &#125;
</code></pre>
<p>通过检测系统的 <code>Build</code> 对象来判断当前设备是否为模拟器。具体方法是检测 <code>Build.FINGERPRINT</code> 属性是否包含字符串 <code>&quot;generic&quot;</code>。</p>
<p><a target="_blank" rel="noopener" href="https://ionized-bag-d70.notion.site/04dbaf39091f42519b14decd2a87fde7">模拟器检测对抗</a></p>
<h3 id="反调试检测"><a href="#反调试检测" class="headerlink" title="反调试检测"></a>反调试检测</h3><p>安卓系统自带调试检测函数</p>
<pre><code>fun checkForDebugger() &#123;  
    if (Debug.isDebuggerConnected()) &#123;  
        // 如果调试器已连接，则终止应用程序  
        System.exit(0)  
    &#125;  
&#125;
</code></pre>
<p>debuggable属性</p>
<pre><code>public boolean getAppCanDebug(Context context)//上下文对象为xxActivity.this
&#123;
    boolean isDebug = context.getApplicationInfo() != null &amp;&amp;
            (context.getApplicationInfo().flags &amp; ApplicationInfo.FLAG_DEBUGGABLE) != 0;
    return isDebug;
&#125;
</code></pre>
<p>ptrace检测</p>
<pre><code>int ptrace_protect()//ptrace附加自身线程 会导致此进程TracerPid 变为父进程的TracerPid 即zygote
&#123;
    return ptrace(PTRACE_TRACEME,0,0,0);;//返回-1即为已经被调试
&#125;
</code></pre>
<p>每个进程同时刻只能被1个调试进程ptrace ，主动ptrace本进程可以使得其他调试器无法调试</p>
<p>调试进程名检测</p>
<pre><code>int SearchObjProcess()
&#123;
    FILE* pfile=NULL;
    char buf[0x1000]=&#123;0&#125;;
 
    pfile=popen(&quot;ps&quot;,&quot;r&quot;);
    if(NULL==pfile)
    &#123;
        //LOGA(&quot;SearchObjProcess popen打开命令失败!\n&quot;);
        return -1;
    &#125;
    // 获取结果
    //LOGA(&quot;popen方案:\n&quot;);
    while(fgets(buf,sizeof(buf),pfile))
    &#123;
 
        char* strA=NULL;
        char* strB=NULL;
        char* strC=NULL;
        char* strD=NULL;
        strA=strstr(buf,&quot;android_server&quot;);//通过查找匹配子串判断
        strB=strstr(buf,&quot;gdbserver&quot;);
        strC=strstr(buf,&quot;gdb&quot;);
        strD=strstr(buf,&quot;fuwu&quot;);
        if(strA || strB ||strC || strD)
        &#123;
            return 1;
            // 执行到这里，判定为调试状态
 
        &#125;
    &#125;
    pclose(pfile);
    return 0;
&#125;
</code></pre>
<p>[<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-268155.htm">原创]对安卓反调试和校验检测的一些实践与结论</a></p>
<h3 id="frida检测"><a href="#frida检测" class="headerlink" title="frida检测"></a>frida检测</h3><p><a target="_blank" rel="noopener" href="https://github.com/xxr0ss/AntiFrida">一些Frida检测手段</a></p>
<h2 id="Xposed"><a href="#Xposed" class="headerlink" title="Xposed"></a>Xposed</h2><p>Xposed是一款可以在不修改APK的情况下影响程序运行的框架，基于它可以制作出许多功能强大的模块，且在功能不冲突的情况下同时运作。在这个框架下，我们可以编写并加载自己编写的插件APP，实现对目标apk的注入拦截等。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>用自己实现的<strong>app_process</strong>替换掉了系统原本提供的<strong>app_process</strong>，加载一个额外的jar包，入口从原来的： **com.android.internal.osZygoteInit.main()被替换成了： de.robv.android.xposed.XposedBridge.main()**，<br>创建的Zygote进程就变成Hook的Zygote进程了，从而完成对zygote进程及其创建的Dalvik&#x2F;ART虚拟机的劫持(zytoge注入)</p>
<p><img src="https://raw.githubusercontent.com/todis21/image/main/2024/image-20240317180905810.png" alt="image-20240317180905810"></p>
<h3 id="Xposed的发展及免root框架"><a href="#Xposed的发展及免root框架" class="headerlink" title="Xposed的发展及免root框架"></a>Xposed的发展及免root框架</h3><table>
<thead>
<tr>
<th>名称</th>
<th>地址</th>
<th>支持版本</th>
<th>是否免root</th>
</tr>
</thead>
<tbody><tr>
<td>xposed</td>
<td><a target="_blank" rel="noopener" href="https://github.com/rovo89/Xposed">https://github.com/rovo89/Xposed</a></td>
<td>2.3-8.1</td>
<td>否</td>
</tr>
<tr>
<td>EDXposed</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ElderDrivers/EdXposed">https://github.com/ElderDrivers/EdXposed</a></td>
<td>8.0-10</td>
<td>否</td>
</tr>
<tr>
<td>LSPosed</td>
<td><a target="_blank" rel="noopener" href="https://github.com/LSPosed/LSPosed">https://github.com/LSPosed/LSPosed</a></td>
<td>8.1-13</td>
<td>否</td>
</tr>
<tr>
<td>VirtualXposed</td>
<td><a target="_blank" rel="noopener" href="https://github.com/android-hacker/VirtualXposed">https://github.com/android-hacker/VirtualXposed</a></td>
<td>5.0-10.0</td>
<td>是</td>
</tr>
<tr>
<td>太极</td>
<td><a target="_blank" rel="noopener" href="https://www.coolapk.com/apk/me.weishu.exp">https://www.coolapk.com/apk/me.weishu.exp</a></td>
<td>5.0-10.0</td>
<td>是</td>
</tr>
<tr>
<td>两仪</td>
<td><a target="_blank" rel="noopener" href="https://www.coolapk.com/apk/io.twoyi">https://www.coolapk.com/apk/io.twoyi</a></td>
<td>8.1-12</td>
<td>是</td>
</tr>
<tr>
<td>天鉴</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Katana-Official/SPatch-Update">https://github.com/Katana-Official/SPatch-Update</a></td>
<td>6-10</td>
<td>是</td>
</tr>
</tbody></table>
<p>多阅读他人代码，学习</p>
<p><a target="_blank" rel="noopener" href="https://www.xda-developers.com/best-xposed-modules/">2022 最好的Xposed模块: GravityBox, Pixelify, XPrivacyLua</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Lstaynight/xposed-dy">基于Xposed的抖音爬虫，抖音风控后自动一键新机，模拟一个全新的运行环境</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/svengong/xcubebase">基于xposed的frida持久化方案</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/monkeylord/XServer">A Xposed Module for Android Penetration Test, with NanoHttpd.</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/GravityBox/GravityBox">GravityBox</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Xposed-Modules-Repo">Xposed-Modules-Repo</a>]</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ferredoxin/QNotified">一个旨在使QQ变得更好用的开源Xposed模块</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/nining377/dolby_beta">杜比大喇叭</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/shatyuka/Zhiliao">知乎去广告Xposed模块</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/yujincheng08/BiliRoaming">哔哩漫游</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Mocha-L/QuJing">曲境</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/monkeylord/XposedTemplateForAS">自动化创建Xposed模块及钩子，让Xposed模块编写时只需关注钩子实现</a></p>
<p>编写Xposed需要的api</p>
<p><a target="_blank" rel="noopener" href="https://github.com/bywhat/XposedBridgeApi">https://github.com/bywhat/XposedBridgeApi</a></p>
<p>下载后将需要的版本添加到依赖</p>
<p>XPosed模块编写查看文章：<br><a target="_blank" rel="noopener" href="https://todis21.github.io/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/">https://todis21.github.io/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/</a></p>
<p>Xposed模块patch</p>
<p><a target="_blank" rel="noopener" href="https://github.com/LSPosed/LSPatch">LSPatch</a> 可以理解为无需root的 LSPosed框架</p>
<p>快速Hook</p>
<p><a target="_blank" rel="noopener" href="https://github.com/littleWhiteDuck/SimpleHook">SimpleHook</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Xposed-Modules-Repo/me.jsonet.jshook">jshook</a></p>
<h2 id="密码学相关"><a href="#密码学相关" class="headerlink" title="密码学相关"></a>密码学相关</h2><p>学这个是为了算法还原、协议分析、对抗等。</p>
<p>编码：</p>
<p>Base64编码、Hex编码、Unicode编码、Byte</p>
<p>加密算法：</p>
<p>MD5加密、AES 、DEA 、RSA 、RC4</p>
<p>….（头皮发麻.jpg）</p>
<p>遇到非标准加密算法：</p>
<p>方法一:主动调用 方法二:扣算法 方法三:ChatGPT</p>
<h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Tree</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/03/15/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80-%E4%B8%80/">http://example.com/2024/03/15/安卓逆向基础-一/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Tree's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-7pq62v_2560x1440.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/" title="Xposed模块编写学习"><img class="cover" src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-x6262z_2560x1440.png" onerror="onerror=null;src='/img/404.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Xposed模块编写学习</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/09/JetBrains-TeamCity%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" title="JetBrains TeamCity漏洞分析"><img class="cover" src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-3kp68d_2560x1440.png" onerror="onerror=null;src='/img/404.png'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JetBrains TeamCity漏洞分析</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/" title="Xposed模块编写学习"><img class="cover" src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-x6262z_2560x1440.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-18</div><div class="title">Xposed模块编写学习</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.jfif" onerror="this.onerror=null;this.src='/img/404.png'" alt="avatar"/></div><div class="author-info__name">Tree</div><div class="author-info__description">随便都行都可以</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/todis21"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/todis21" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3440848736@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">安卓逆向基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APK%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">APK文件结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E5%BC%80%E5%8F%8A%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">双开及原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">安卓四大组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Activity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.5.</span> <span class="toc-text">Activity生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#smali%E8%AF%AD%E6%B3%95"><span class="toc-number">1.6.</span> <span class="toc-text">smali语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">1.7.</span> <span class="toc-text">寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E5%B9%BF%E5%91%8A-x2F-%E5%BC%B9%E7%AA%97"><span class="toc-number">1.8.</span> <span class="toc-text">去广告&#x2F;弹窗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="toc-number">1.9.</span> <span class="toc-text">App动态调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%A1%E9%AA%8C"><span class="toc-number">1.10.</span> <span class="toc-text">校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APK%E7%AD%BE%E5%90%8D"><span class="toc-number">1.11.</span> <span class="toc-text">APK签名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C"><span class="toc-number">1.12.</span> <span class="toc-text">签名校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C%E5%AF%B9%E6%8A%97"><span class="toc-number">1.13.</span> <span class="toc-text">签名校验对抗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PM%E4%BB%A3%E7%90%86"><span class="toc-number">1.14.</span> <span class="toc-text">PM代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IO%E9%87%8D%E5%AE%9A%E5%90%91-%E2%9C%94"><span class="toc-number">1.15.</span> <span class="toc-text">IO重定向(✔)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E6%A3%80%E6%B5%8B"><span class="toc-number">1.16.</span> <span class="toc-text">各种检测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#root%E6%A3%80%E6%B5%8B%EF%BC%9A"><span class="toc-number">1.16.1.</span> <span class="toc-text">root检测：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E5%99%A8%E6%A3%80%E6%B5%8B"><span class="toc-number">1.16.2.</span> <span class="toc-text">模拟器检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E8%B0%83%E8%AF%95%E6%A3%80%E6%B5%8B"><span class="toc-number">1.16.3.</span> <span class="toc-text">反调试检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#frida%E6%A3%80%E6%B5%8B"><span class="toc-number">1.16.4.</span> <span class="toc-text">frida检测</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Xposed"><span class="toc-number">1.17.</span> <span class="toc-text">Xposed</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.17.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Xposed%E7%9A%84%E5%8F%91%E5%B1%95%E5%8F%8A%E5%85%8Droot%E6%A1%86%E6%9E%B6"><span class="toc-number">1.17.2.</span> <span class="toc-text">Xposed的发展及免root框架</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9B%B8%E5%85%B3"><span class="toc-number">1.18.</span> <span class="toc-text">密码学相关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#END"><span class="toc-number">1.19.</span> <span class="toc-text">END</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/03/CVE-2024-36401-GeoServer-XPath-rce/" title="CVE-2024-36401 GeoServer XPath rce"><img src="https://raw.githubusercontent.com/todis21/image/main/202304031628382.png" onerror="this.onerror=null;this.src='/img/404.png'" alt="CVE-2024-36401 GeoServer XPath rce"/></a><div class="content"><a class="title" href="/2024/07/03/CVE-2024-36401-GeoServer-XPath-rce/" title="CVE-2024-36401 GeoServer XPath rce">CVE-2024-36401 GeoServer XPath rce</a><time datetime="2024-07-03T03:41:52.000Z" title="发表于 2024-07-03 11:41:52">2024-07-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/26/Apache-Kafka-UI-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" title="Apache Kafka UI 远程代码执行漏洞分析"><img src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-x6gyyv_2560x1440.png" onerror="this.onerror=null;this.src='/img/404.png'" alt="Apache Kafka UI 远程代码执行漏洞分析"/></a><div class="content"><a class="title" href="/2024/06/26/Apache-Kafka-UI-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" title="Apache Kafka UI 远程代码执行漏洞分析">Apache Kafka UI 远程代码执行漏洞分析</a><time datetime="2024-06-26T06:44:32.000Z" title="发表于 2024-06-26 14:44:32">2024-06-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/04/01/Frida%E5%AD%A6%E4%B9%A0/" title="Frida学习"><img src="https://w.wallhaven.cc/full/76/wallhaven-76e1mv.jpg" onerror="this.onerror=null;this.src='/img/404.png'" alt="Frida学习"/></a><div class="content"><a class="title" href="/2024/04/01/Frida%E5%AD%A6%E4%B9%A0/" title="Frida学习">Frida学习</a><time datetime="2024-04-01T09:38:31.000Z" title="发表于 2024-04-01 17:38:31">2024-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/26/CVE-2024-23328%E5%88%86%E6%9E%90/" title="CVE-2024-23328分析"><img src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-kx62e1_1920x1080.png" onerror="this.onerror=null;this.src='/img/404.png'" alt="CVE-2024-23328分析"/></a><div class="content"><a class="title" href="/2024/03/26/CVE-2024-23328%E5%88%86%E6%9E%90/" title="CVE-2024-23328分析">CVE-2024-23328分析</a><time datetime="2024-03-26T03:28:40.000Z" title="发表于 2024-03-26 11:28:40">2024-03-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/" title="Xposed模块编写学习"><img src="https://raw.githubusercontent.com/todis21/image/main/2024/wallhaven-x6262z_2560x1440.png" onerror="this.onerror=null;this.src='/img/404.png'" alt="Xposed模块编写学习"/></a><div class="content"><a class="title" href="/2024/03/18/Xposed%E6%A8%A1%E5%9D%97%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/" title="Xposed模块编写学习">Xposed模块编写学习</a><time datetime="2024-03-18T15:13:31.000Z" title="发表于 2024-03-18 23:13:31">2024-03-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Tree</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="喵" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>